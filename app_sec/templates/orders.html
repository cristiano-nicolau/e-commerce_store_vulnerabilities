<!-- /*
* Bootstrap 5
* Template Name: Furni
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="../images/favicon.png">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

		<!-- Bootstrap CSS -->
		<link href="../css/bootstrap.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="../css/tiny-slider.css" rel="stylesheet">
		<link href="../css/style.css" rel="stylesheet">
		<title>DETI - Departamento de Electrónica, Telecomunicações e Informática </title>
	</head>
<style>
	body{
		background-color: #f5f5f5;	}

</style>
	<body>

		<!-- Start Header/Navigation -->
		<nav class="custom-navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">
			<div class="container">
				<a class="navbar-brand" href="index.html">DETI Store<span>.</span></a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
		
				<div class="collapse navbar-collapse" id="navbarsFurni">
					<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
						<li class="nav-item">
							<a class="nav-link" href="index.html">Home</a>
						</li>
						<li><a class="nav-link" href="shop.html">Shop</a></li>
						<li><a class="nav-link" href="about.html">About us</a></li>
					</ul>
		
					<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
						<li id="Admin" class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
								<img src="../images/user_copy.svg">
							</a>
							<ul class="dropdown-menu" aria-labelledby="userDropdown">
								<li><a class="dropdown-item" href="userdashboard.html">Account Details</a></li>
								<li><hr class="dropdown-divider"></li>
								<li id="logout"><a class="dropdown-item text-danger" >Logout</a></li>
							</ul>
						</li>
						<li id="User" class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
								<img src="../images/user_copy.svg">
							</a>
							<ul class="dropdown-menu" aria-labelledby="userDropdown">
								<li><a class="dropdown-item" href="userdashboard.html">Account Details</a></li>
								<li><a class="dropdown-item" href="orders.html">Orders</a></li>
								<li><hr class="dropdown-divider"></li>
								<li id="logout-id"><a class="dropdown-item text-danger" >Logout</a></li>
							</ul>
						</li>
						<li id="NotAuthenticated"><a class="nav-link" href="reg_log.html"><img src="../images/user.svg"></a></li>
						<li id="Cart"><a class="nav-link" href="cart.html"><img src="../images/cart.svg"></a></li>
					</ul>
				</div>
			</div>
		</nav>
		
		<!-- End Header/Navigation -->
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <div class="container" style="margin-top: 20px;">
            <div class="row flex-lg-nowrap">
                <!-- Sidebar -->
                <div class="col-12 col-lg-auto mb-3" style="width: 200px;">
                    <div class="card p-3">
                        <div class="e-navlist e-navlist--active-bg">
                            <ul class="nav">
                                <li class="nav-item"><a class="nav-link px-2" href="userdashboard.html"><i class="fa fa-user mr-1"></i><span> Overview</span></a></li>
                                <li class="nav-item"><a class="nav-link px-2 active" href="orders.html"><i class="fa fa-shipping-fast mr-1"></i><span>ORDERS</span></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Orders Section -->
                <div class="col-12 col-md-9 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-title font-weight-bold">Your Orders</h6>
                            <!-- This is a placeholder for your orders. Replace this table with your actual orders structure -->
							<div id="orders-list"></div>
                        </div>
                    </div>
                </div>
        
<!-- Support Section -->
<div class="col-12 col-md-3 mb-3">
    <div class="card">
      <div class="card-body">
        <h6 class="card-title font-weight-bold">Support</h6>
        <p class="card-text">Get fast, free help from our friendly assistants.</p>
        <a href="about.html">
            <button type="button" class="btn btn-primary">Contact Us</button>
        </a>
        
      </div>
    </div>
  </div>


            </div>
        </div>
            
 
		<!-- Start Footer Section -->
		<footer class="footer-section">
			<div class="container relative">


				<div class="row g-5 mb-5">
					<div class="col-lg-4">
						<div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">DETI Store<span>.</span></a></div>
						<p class="mb-4">DETI, or the Department of Electronics, Telecommunications, and Informatics, is a pioneering academic department at our university. Known for its commitment to excellence, DETI offers cutting-edge programs, research opportunities, and a vibrant community where innovation thrives.</p>

						<ul class="list-unstyled custom-social">
							<li><a href="#"><span class="fa fa-brands fa-facebook-f"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-twitter"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-instagram"></span></a></li>
							<li><a href="#"><span class="fa fa-brands fa-linkedin"></span></a></li>
						</ul>
					</div>

					<div class="col-lg-8">
						<div class="row links-wrap">
							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">About us</a></li>
									<li><a href="#">Services</a></li>
									<li><a href="reviews.html">Reviews</a></li>
									<li><a href="#">Contact us</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Support</a></li>
									<li><a href="#">Knowledge base</a></li>
									<li><a href="#">Live chat</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="#">Jobs</a></li>
									<li><a href="#">Our team</a></li>
									<li><a href="#">Leadership</a></li>
									<li><a href="#">Privacy Policy</a></li>
								</ul>
							</div>

							
						</div>
					</div>

				</div>

				<div class="border-top copyright">
					<div class="row pt-4">
						<div class="col-lg-6">
							<p class="mb-2 text-center text-lg-start">Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a> Distributed By <a hreff="https://themewagon.com">ThemeWagon</a>  <!-- License information: https://untree.co/license/ -->
            </p>
						</div>

						<div class="col-lg-6 text-center text-lg-end">
							<ul class="list-unstyled d-inline-flex ms-auto">
								<li class="me-4"><a href="#">Terms &amp; Conditions</a></li>
								<li><a href="#">Privacy Policy</a></li>
							</ul>
						</div>

					</div>
				</div>

			</div>
		</footer>
		<!-- End Footer Section -->	
		<script>
			const logoutButton = document.getElementById("logout-id");
			logoutButton.addEventListener("click", function() {
        	fetch('http://127.0.0.1:5000/logout',{
				method: 'POST',
				headers: {
					'Authorization': localStorage.getItem('token')
				}
			})
				.then(response => response.json())
				.then(data => {
					if (data.success) {

						window.location.href = "index.html";
					}
				})
				.catch(error => {
					console.error('Error:', error);
				});

				localStorage.removeItem('token');
				localStorage.removeItem('user_id');
				window.location.href = "index.html";})
					 function checkToken() {
			const token = localStorage.getItem('token'); // Verifique o token armazenado no localStorage
			var Admin = document.getElementById('Admin');
            var User = document.getElementById('User');
            var NotAuthenticated = document.getElementById('NotAuthenticated');
			if (token) {
				fetch('http://127.0.0.1:5000/user_info', {
					method: 'GET',
					headers: {
					'Authorization': token 
					}
				})
				.then(response => response.json())
				.then(data => {
				// Verifique se o usuário está autenticado e recupere o tipo de usuário
				if (data.is_authenticated) {
					if (data.user_type === 'admin') {
						Admin.style.display = 'block';
						User.style.display = 'none';
						NotAuthenticated.style.display = 'none';
					} else {
						Admin.style.display = 'none';
						User.style.display = 'block';
						NotAuthenticated.style.display = 'none';
					}
				} else {
					Admin.style.display = 'none';
					User.style.display = 'none';
					NotAuthenticated.style.display = 'block';
				}
				})
				.catch(error => {
				console.error('Erro ao buscar informações do usuário:', error);
				});
			} else {
				Admin.style.display = 'none';
                User.style.display = 'none';
                NotAuthenticated.style.display = 'block';
			}
		}
		checkToken();
		</script>
		<script>
			function fetchUserOrders() {
				const userId = localStorage.getItem('user_id');
				const ordersTableBody = document.getElementById('orders-list');
		
				fetch(`http://127.0.0.1:5000/user_orders/${userId}`, { method: 'GET' })
					.then(response => response.json())
					.then(data => {
						data.forEach(order => {
							const orderRow = document.createElement('tr');
							orderRow.innerHTML = `
								<td colspan="4">
									<strong>Order ID:</strong> ${order.order_id}<br>
									<strong>Date:</strong> ${order.order_date}<br>
									<strong>Status:</strong> ${order.order_status}<br>
									
									<table>
										<tr>
											<th>Product Name</th>
											<th>Product ID</th>
											<th>Quantity</th>
											<th>Unit Price</th>
										</tr>
										${order.order_items.map(item => `
											<tr>
												<td>${item.product_name}</td>
												<td>${item.product_id}</td>
												<td>${item.quantity}</td>
												<td>${item.unit_price}</td>
											</tr>
										`).join('')}
									</table>
									<button onclick="reorder(${order.order_id})" class="btn btn-secondary mt-4">ReOrder</button>
								</td>
							`;
							ordersTableBody.appendChild(orderRow);
						});
					})
					.catch(error => console.error('Error fetching orders:', error));
			}
		
			fetchUserOrders();
		</script>
<script>
	function reorder(orderId) {
        const userId = localStorage.getItem('user_id');
        fetch(`http://127.0.0.1:5000/reorder/${userId}/${orderId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Redirect to the cart page
                window.location.href = "cart.html";
            } else {
                console.error('Error reordering items:', data.error);
            }
        })
        .catch(error => console.error('Network error:', error));
    }



</script>
		<script src="../js/bootstrap.bundle.min.js"></script>
		<script src="../js/tiny-slider.js"></script>
		<script src="../js/custom.js"></script>
	</body>

</html>
